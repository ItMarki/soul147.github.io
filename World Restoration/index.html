
<!DOCTYPE html>
<head>
	<link rel="stylesheet" type="text/css" href="a.css">
<script type="text/javascript" src="https://gc.kis.v2.scr.kaspersky-labs.com/A2285C8D-6804-9E48-B56F-292E94B644D2/main.js" charset="UTF-8"></script></head>
<body>
	<div>
		<button onclick = "tab('before')"  id = "BL" style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="before">Before Life</button>
		<button onclick = "tab('newepisode')"  id = "NE" style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="normal">New Episode</button>
		<button onclick = "tab('newcakeatstake')"  id = "NCa" style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="normal">New Cake at Stake</button>
		<button id = "BL" style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="box">Automation (coming soon)</button>
		<!--<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="normal">New Contest</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="normal">New Session</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="normal">New Season</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="normal">New Life</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New World</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New System</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Galaxy</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Galaxy Cluster</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Galaxy Supercluster</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Universe</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Multiverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Megaverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Gigaverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Teraverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Petaverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Exaverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Zettaverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Yottaverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="unima">New Reality</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="unima">New Existence</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="unima">New Transcendence</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="unima">New Ultraverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="unima">New Omniverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="unima">New Monocosm</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="unima">New Beyond</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="unima">New Transcendentem</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="unima">New Transcendentem Continuum</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="unima">New Altarca</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="unima">New Metempiric Space</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="box">The Box</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Prestige</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Ascend</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Transcend</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Reset</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Reborn</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Sacrifice</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Resurrection</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Big Crunch</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-New Universe</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Ultimate Fate</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Max</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Super Max</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Start Over</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Next Level</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Next Stage</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Next Zone</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Next World</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Next Planet</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Next Star</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Next Bubble</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Next Belt</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Next Galaxy</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Next Cluster</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Next Supercluster</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Next Supercluster Filament</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Big Freeze</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Big Rip</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Big Bang</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Big Bounce</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="sight">Meta-New Parallel Universe</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="sight">Meta-New Multiverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="sight">Meta-New Megaverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="sight">Meta-New Gigaverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="sight">Meta-New Teraverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="sight">Meta-New Petaverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="sight">Meta-New Exaverse</button>-->
	</div>
	
	You have repelled <span id = "forks"></span> forks.<br>
	
	<div id = "before" class = "tab">
		<table id = "frlist"></table>
	</div>

	<br>
	
	<div id = "newepisode" class = "tab">
		<button class="normal" onclick = "newEpisode()">Start a New Episode<br>Gain <span id = "keygain"></span> keys</button><br>
		You have started <span id = "newepisodetimes"></span> new episodes.<br>
		You have <span class = "keys"></span> keys.<br>
		<table id = "neupgrades">
			<tr>
				<td id = "neu1" width = "20%"><button id = "neu1b" onclick = "buyNEUpgrade(0)" style = "width: 100%">FRs repel faster based on unspent keys<br>Currently: x<span id = "neu1i"></span><br>Cost: <span id = "neu1c"></span> Keys</button></td>
				<td id = "neu2" width = "20%"><button id = "neu2b" onclick = "buyNEUpgrade(1)" style = "width: 100%">FRs repel 10% faster for every 10 bought<br>Currently: x<span id = "neu2i"></span><br>Cost: <span id = "neu2c"></span> Keys</button></td>
				<td id = "neu3" width = "20%"><button id = "neu3b" onclick = "buyNEUpgrade(2)" style = "width: 100%">FRs repel faster based on new episodes<br>Currently: x<span id = "neu3i"></span><br>Cost: <span id = "neu3c"></span> Keys</button></td>
				<td id = "neum" width = "20%"><button id = "neumb" onclick = "buyKeyMultiplier()" style = "width: 100%">You gain <span id = "keymultinc"></span>% more keys<br>Currently: x<span id = "neumi"></span><br>Cost: <span id = "neumc"></span> Keys</button></td>
			</tr>
		</table>
	</div>
	
	<div id = "newcakeatstake" class = "tab">
		You have <span class = "keys"></span> keys.<br>
		<button class="normal" onclick = "newCakeAtStake()">Start a New Cake at Stake<br><span id = "cakegain"></span></button><button class="normal" id = "exitbrake" onclick = "newCakeAtStake(true)">Exit BaF</button><br>
		<input type = "checkbox" id = "brake" onclick = "toggleBrakeAtFlake()">Enable Brake at Flake - In BaF, NCa upgrades and key multipliers do nothing, but you gain empowered cakes which will boost production.<br>
		You have put <span id = "newcakeatstaketimes"></span> cakes at stake.<br>
		You have <span class = "cakes"></span> cakes.<br>
		<span id = "empoweredcaketext">You have <span id = "empoweredcakes"></span> empowered cakes, multiplying all FRs by x<span id = "empoweredcakeeffect"></span>.<br></span>
		<table id = "ncaupgrades">
			<tr>
				<td id = "ncau1" width = "20%"><button id = "ncau1b" onclick = "buyNCaUpgrade(0)" style = "width: 100%">FRs repel faster based on unspent cakes<br>Currently: x<span id = "ncau1i"></span><br>Cost: <span id = "ncau1c"></span> Cakes</button></td>
				<td id = "ncau2" width = "20%"><button id = "ncau2b" onclick = "buyNCaUpgrade(1)" style = "width: 100%">FRs repel 20% faster for every 25 bought<br>Currently: x<span id = "ncau2i"></span><br>Cost: <span id = "ncau2c"></span> Cakes</button></td>
				<td id = "ncaum" width = "20%"><button id = "ncaumb" onclick = "buyCakeMultiplier()" style = "width: 100%">You gain 5% more cakes<br>Currently: x<span id = "ncaumi"></span><br>Cost: <span id = "ncaumc"></span> Cakes</button></td>
				<td id = "ncaun" width = "20%"><button id = "ncaunb" onclick = "buyCakeMultiplier2()" style = "width: 100%">You gain 10% more empowered cakes in BaF<br>Currently: x<span id = "ncauni"></span><br>Cost: <span id = "ncaunc"></span> Cakes</button></td>
			</tr>
		</table>
	</div>

	<footer style = "position: fixed; bottom: 0; left: 0; padding: 10px">
		I take absolutely zero credit for this game. I just developed <a href = "https://sites.google.com/view/worldrestoration/main-page/main-game" target = "_blank">ItMarki's game concept</a>, using <a href = "https://github.com/Patashu/break_eternity.js" target = "_blank">Patashu's break_eternity.js</a> and formatting code taken from <a href = "https://ivark.github.io" target = "_blank">hevipelle's Antimatter Dimensions</a>.<br>
		Dravitar is making his own version of World Restoration, which can be found <a href = "https://dravitar.github.io/World-Restoration/" target = "_blank">here</a>. I would suggest playing that one too, they're basically two different games, each one unique and offering a different experience.
	</footer>
</body>
	
<script src = "format.js"></script>
<script src = "break_eternity.js"></script>

<script>

// This is getting to be a thing, isn't it?

function ge(e) {
	return document.getElementById(e);
}

// Automatically fill all of that class

function gc(e, f) {
	l = document.getElementsByClassName(e);
	for(var i = 0; i < l.length; i++) {
		f(l[i]);
	}
}

// Tab switching

function tab(t) {
	// hide everything
	
	var classList = document.getElementsByClassName("tab");
	for(var i = 0; i < classList.length; i++) {
		classList[i].style.display = "none"
	}
	
	// unhide the selected tab
	
	ge(t).style.display = ""
}

tab("before")

// Setup repellent HTML

HTML = "<tr>"
for(var i = 1; i <= 80; i++) {
	if(i % 4 == 1) HTML += "</tr><tr>"
	HTML += '<td id = "fr'+i+'" width = "20%">Fork Repellent '+i+'<br>Amount: <span id = "fr'+i+'a"></span><br>Multiplier: x<span id = "fr'+i+'m"></span><br>Production: <span id = "fr'+i+'p"></span> forks/s<br><button id = "fr'+i+'b" onclick = "buyFR('+i+')">Cost: <span id = "fr'+i+'c"></span> forks</button></td>'
}
ge("frlist").innerHTML += HTML

// The game. Fairly simple.

game = {
	lastUpdate: Date.now(),
	options: {
		notation: "Mixed scientific"
	},
}

// This function is used a lot.

function reset(layers) {
	if(layers > 0) {
		game.forks = new Decimal(10);
		game.totalFRBought = new Decimal(0);
		for(var i = 1; i <= 80; i++) {
			j = i - 1;
			game["fr" + i] = {
				amount: new Decimal(0),
				mult: new Decimal(1.2**j),
				buyMult: new Decimal(1.1),
				cost: new Decimal(10*1.7**j),
				costMult: new Decimal(1.5),
			}
		}
	}
	if(layers > 1) {
		game.keys = new Decimal(0);
		game.neUpgrades = [];
		game.keyMultiplier = new Decimal(1);
		game.keyMultiplierCost = new Decimal(1000);
	}
	if(layers > 2) {
		game.cakes = new Decimal(0);
		game.empoweredCakes = new Decimal(0);
		game.ncaUpgrades = [];
		game.cakeMultiplier = new Decimal(1);
		game.cakeMultiplierCost = new Decimal(1000);
		game.cakeMultiplier2 = new Decimal(1);
		game.cakeMultiplier2Cost = new Decimal(1e6);
		game.brake = false;
	}
	if(layers == Infinity) {
		game.newEpisode = new Decimal(0);
		game.newCakeAtStake = new Decimal(0);
	}
}

function getUnlockedFR() {
	u = 1;
	
	if(game.newEpisode.gt(0)) u *= 4;
	if(game.newCakeAtStake.gt(0)) u += 4;
	
	return u;
}

function buyFR(n) {
	fr = game["fr" + n];
	if(game.forks.lt(fr.cost)) return;
	// game.forks = game.forks.subtract(fr.cost); // COMMUNISM
	fr.amount = fr.amount.add(1)
	game.totalFRBought = game.totalFRBought.add(1)
	fr.mult = fr.mult.multiply(fr.buyMult)
	fr.cost = fr.cost.multiply(fr.costMult)
	return true;
}

function buyMaxAll() {
	for(var i = 1; i <= getUnlockedFR(); i++) while(buyFR(i));
}

function save() {
	localStorage.wr = btoa(JSON.stringify(game))
}

function load() {
	if(!localStorage.wr) return;
	game = JSON.parse(atob(localStorage.wr))
	
	transformToDecimal(game)
}

function transformToDecimal(object) { // It's so much better than hevi's version, because it's recursive and I'm a lazy piece of shit
	for(i in object) {
		if(typeof(object[i]) == "string" && !isNaN(new Decimal(object[i]).mag)) object[i] = new Decimal(object[i]); 
		if(typeof(object[i]) == "object") transformToDecimal(object[i]) // iterates over all objects inside the object
	}
}

reset(Infinity);

load();

</script>

<script src = "js/NE.js"></script>
<script src = "js/NCa.js"></script>

<script>

function update() {
	diff = Date.now() - game.lastUpdate;
	game.lastUpdate = Date.now();
	
	// Hackerman
	
	diff *= parseInt(localStorage.hacker) || 1
	
	for(var i = 1; i <= 80; i++) {
		fr = game["fr" + i]
		fr.production = fr.amount.multiply(fr.mult)
		fr.production = fr.production.multiply(getEmpoweredCakeEffect())
		if(game.neUpgrades.includes(0)) fr.production = fr.production.multiply(getNEUpgradeEffect(0));
		if(game.neUpgrades.includes(1)) fr.production = fr.production.multiply(getNEUpgradeEffect(1));
		if(game.neUpgrades.includes(2)) fr.production = fr.production.multiply(getNEUpgradeEffect(2));
		if(game.ncaUpgrades.includes(0)) fr.production = fr.production.multiply(getNCaUpgradeEffect(0));
		if(game.ncaUpgrades.includes(1)) fr.production = fr.production.multiply(getNCaUpgradeEffect(1));
		game.forks = game.forks.add(fr.production.multiply(diff/1000))
		
		ge("fr"+i+"a").innerHTML = shortenMoney(fr.amount);
		ge("fr"+i+"m").innerHTML = shorten(fr.mult);
		ge("fr"+i+"p").innerHTML = shortenMoney(fr.production);
		ge("fr"+i+"c").innerHTML = shortenMoney(fr.cost);
		ge("fr"+i+"b").style.backgroundColor = game.forks.gte(fr.cost) ? "#0f0" : "#f00"
		
		ge("fr"+i).style.display = (!game["fr" + (i-1)] || game["fr" + (i-1)].amount.gt(0)) && getUnlockedFR() >= i ? "" : "none"
	}
	
	if(game.newEpisode.gt(0)) buyMaxAll();
	if(game.newCakeAtStake.gt(0)) game.keys = game.keys.add(gainedKeys().multiply(diff/1e5))
	
	ge("forks").innerHTML = shortenMoney(game.forks);
	
	ge("newepisodetimes").innerHTML = shorten(game.newEpisode);
	gc("keys", function(n) {n.innerHTML = shortenMoney(game.keys)})
	ge("keygain").innerHTML = shortenMoney(gainedKeys());
	ge("neu1b").style.backgroundColor = game.neUpgrades.includes(0) ? "#0f0" : game.keys.gte(game.neUpgradeCosts[0]) ? "#fff" : "#f00"
	ge("neu1i").innerHTML = shorten(getNEUpgradeEffect(0));
	ge("neu1c").innerHTML = shortenCosts(game.neUpgradeCosts[0]);
	ge("neu2b").style.backgroundColor = game.neUpgrades.includes(1) ? "#0f0" : game.keys.gte(game.neUpgradeCosts[1]) ? "#fff" : "#f00"
	ge("neu2i").innerHTML = shorten(getNEUpgradeEffect(1));
	ge("neu2c").innerHTML = shortenCosts(game.neUpgradeCosts[1]);
	ge("neu3b").style.backgroundColor = game.neUpgrades.includes(2) ? "#0f0" : game.keys.gte(game.neUpgradeCosts[2]) ? "#fff" : "#f00"
	ge("neu3i").innerHTML = shorten(getNEUpgradeEffect(2));
	ge("neu3c").innerHTML = shortenCosts(game.neUpgradeCosts[2]);
	ge("neumb").style.backgroundColor = game.keys.gte(game.keyMultiplierCost) && !game.brake ? "#fff" : "#f00"
	ge("neumi").innerHTML = shorten(getKeyMultiplier());
	ge("neumc").innerHTML = shortenMoney(game.keyMultiplierCost);
	
	ge("newcakeatstaketimes").innerHTML = shorten(game.newCakeAtStake);
	gc("cakes", function(n) {n.innerHTML = shortenMoney(game.cakes)})
	ge("empoweredcaketext").style.display = game.empoweredCakes.eq(0) ? "none" : ""
	ge("exitbrake").style.display = game.brake ? "" : "none"
	ge("empoweredcakes").innerHTML = shortenMoney(game.empoweredCakes);
	ge("cakegain").innerHTML = game.brake ? (gainedCakes().gt(0) ? "Gain " + shortenMoney(gainedCakes()) + " empowered cakes" : "Reach " + shortenMoney(getECReq()) + " keys") : gainedCakes().gt(0) ? "Gain " + shortenMoney(gainedCakes()) + " cakes" : "Reach " + shortenMoney(1e6) + " keys"
	ge("ncau1b").style.backgroundColor = game.ncaUpgrades.includes(0) ? "#0f0" : game.cakes.gte(game.ncaUpgradeCosts[0]) ? "#fff" : "#f00"
	ge("ncau1i").innerHTML = shorten(getNCaUpgradeEffect(0));
	ge("ncau1c").innerHTML = shortenCosts(game.ncaUpgradeCosts[0]);
	ge("ncau2b").style.backgroundColor = game.ncaUpgrades.includes(1) ? "#0f0" : game.cakes.gte(game.ncaUpgradeCosts[1]) ? "#fff" : "#f00"
	ge("ncau2i").innerHTML = shorten(getNCaUpgradeEffect(1));
	ge("ncau2c").innerHTML = shortenCosts(game.neUpgradeCosts[1]);
	ge("ncaumb").style.backgroundColor = game.cakes.gte(game.cakeMultiplierCost) ? "#fff" : "#f00"
	ge("ncaumi").innerHTML = shorten(game.cakeMultiplier);
	ge("ncaumc").innerHTML = shortenMoney(game.cakeMultiplierCost);
	ge("ncaunb").style.backgroundColor = game.cakes.gte(game.cakeMultiplier2Cost) ? "#fff" : "#f00"
	ge("ncauni").innerHTML = shorten(game.cakeMultiplier2);
	ge("ncaunc").innerHTML = shortenMoney(game.cakeMultiplier2Cost);
	ge("empoweredcakeeffect").innerHTML = shorten(getEmpoweredCakeEffect());
	ge("brake").checked = game.brakeNext;
	ge("keymultinc").innerHTML = game.brake ? "0" : "5";
	
	save();
}

setInterval(update, 50);

</script>
